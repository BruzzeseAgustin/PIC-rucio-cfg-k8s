image:
  # tag: release-1.24.3
  # tag: release-1.23.8_py3
  tag: release-1.25.4.post1
  pullPolicy: IfNotPresent
  # pullPolicy: Always

automatixCount: 1
abacusAccountCount: 1
abacusRseCount: 1
abacusCollectionReplicaCount: 2
conveyorTransferSubmitterCount: 2
conveyorPollerCount: 2
conveyorFinisherCount: 2
conveyorReceiverCount: 2
conveyorThrottlerCount: 2
hermesCount: 0
hermes2Count: 1
judgeCleanerCount: 1
judgeEvaluatorCount: 1
judgeInjectorCount: 1
judgeRepairerCount: 1
tracerKronosCount: 1
transmogrifierCount: 1
undertakerCount: 1
reaper2Count: 1
reaperCount: 0
minosCount: 1
necromancerCount: 1
undertakerCount: 1

monitoring:
  enabled: true
  exporterPort: 8080
  targetPort: 8080
  interval: 30s
  telemetryPath: /metrics
  labels:
    app: prometheus

automatix:
  threads: 1
  inputFile: "/opt/rucio/etc/automatix.json"
  resources:
    limits:
      memory: "200Mi"
      cpu: "300m"
    requests:
      memory: "100Mi"
      cpu: "100m"

abacusAccount:
  threads: 1
  resources:
    requests:
      memory: "64Mi"
      cpu: "25m"
    limits:
      memory: "256Mi"
      cpu: "50m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

abacusCollectionReplica:
  threads: 1
  resources:
    limits:
      memory: "200Mi"
      cpu: "700m"
    requests:
      memory: "200Mi"
      cpu: "700m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

abacusRse:
  threads: 1
  resources:
    requests:
      memory: "64Mi"
      cpu: "25m"
    limits:
      memory: "256Mi"
      cpu: "50m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

undertaker:
  threads: 1
  resources:
    limits:
      memory: "200Mi"
      cpu: "700m"
    requests:
      memory: "200Mi"
      cpu: "700m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

reaper:
  resources:
    limits:
      cpu: 1
      memory: 1Gi
    requests:
      cpu: 50m
      memory: 128Mi
  greedy: 1
  totalWorkers: 2
  threadsPerWorker: 2
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

reaper2:
  greedy: 1
  threads: 5
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "100m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

undertaker:
  threads: 1
  resources:
    requests:
      memory: "64Mi"
      cpu: "25m"
    limits:
      memory: "256Mi"
      cpu: "50m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorTransferSubmitter:
  threads: 5
  sleepTime: 2
  activities: "'Data Brokering' 'Data rebalancing' 'Debug' 'Express' 'Functional Test' 'Group Subscriptions' 'Production Input' 'Production Output' 'Analysis Input' 'Analysis Output' 'Staging' 'T0 Export' 'T0 Tape' 'Upload/Download (Job)' 'Upload/Download (User)' 'User Subscriptions'"
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorPoller:
  threads: 4
  sleepTime: 2
  olderThan: 0
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

conveyorFinisher:
  threads: 2
  sleepTime: 5
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeCleaner:
  threads: 1
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeEvaluator:
  threads: 1
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

hermes:
  threads: 2
  bulk: 100
  delay: 5
  brokerTimeout: 3
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

hermes2:
  threads: 1
  bulk: 100
  resources:
    limits:
      memory: "200Mi"
      cpu: "700m"
    requests:
      memory: "200Mi"
      cpu: "700m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeRepairer:
  threads: 1
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeInjector:
  threads: 1
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

reaper:
  workers: 60
  threadsPerWorker: 1
  greedy: 1
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

ftsRenewal:
  enabled: 1
  image:
    repository: rucio/fts-cron
    tag: latest
  servers: "https://fts01.pic.es:8446, https://fts02.pic.es:8446"

transmogrifierResources:
    requests:
      memory: 200Mi
    limits:
      memory: 1450Mi

tracerKronos:
  resources:
    limits:
      cpu: 3000m 
    requests:
      cpu: 1000m 
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeEvaluator: 
  resources:
    limits:
      cpu: 3750m 
    requests:
      cpu: 750m 
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeCleaner:
  threads: 2
  resources:
    limits:
      cpu: 3750m 
      memory: 4000Mi
    requests:
      cpu: 750m 
      memory: 400Mi
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeInjector:
  threads: 2
  resources:
    limits:
      cpu: 3750m 
      memory: 8000Mi
    requests:
      cpu: 750m 
      memory: 400Mi
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

judgeRepairer:
  resources:
    limits:
      cpu: 3750m 
    requests:
      cpu: 750m 
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"

minos:
  threads: 1
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"
  resources:
    limits:
      memory: "200Mi"
      cpu: "700m"
    requests:
      memory: "100Mi"
      cpu: "100m"

minosTemporaryExpiration:
  threads: 1
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"
  resources:
    limits:
      memory: "200Mi"
      cpu: "700m"
    requests:
      memory: "100Mi"
      cpu: "100m"

necromancer:
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"
  resources:
    limits:
      memory: "200Mi"
      cpu: "700m"
    requests:
      memory: "100Mi"
      cpu: "100m"

additionalSecrets:
  x509up:
    secretName: rucio-x509up-reaper
    mountPath: /opt/proxy/x509up.pem
    # subPaths: 
      # - x509up.pem
  automatix-input:
    secretName: automatix
    mountPath: /opt/rucio/etc/automatix.json
    subPath: automatix.json

config:
  database:
    default: "postgresql://rucio:secret@rucio-postgresql/rucio"
    schema: "pic01-rucio"

  messaging_hermes:
    username: "admin"
    password: "admin"
    port: "32005"
    nonssl_port: "32005"
    use_ssl: "false"
    destination: "/queue/events"
    ssl_key_file: "/opt/x509/hostkey.pem"
    ssl_cert_file: "/opt/x509/hostcert.pem"
    brokers: "192.168.96.77"
    email_from: "bruzzese@pic.es"
    email_test: "bruzzese@pic.es"

  # automatix:
    # sites: ""
    # sleep_time: ""
    # database_lifetime: ""
    # set_metadata: ""

  messaging_hermes2:
    elastic_endpoint: 'http://bulk:12345678@elk-jcasals.pic.es:9200/rucio/_bulk/'
    # elastic_endpoint: http://elk-jcasals.pic.es:9200/_bulk/
    # elastic_endpoint: http://es.pic.es:9200/_bulk/

  tracer-kronos:
    username: "admin"
    password: "admin"
    port: "32005"
    nonssl_port: "32005"
    brokers: "192.168.96.77"
    use_ssl: "false"
    ssl_key_file: "/opt/x509/hostkey.pem"
    ssl_cert_file: "/opt/x509/hostcert.pem"
    queue: "/queue/Consumer.kronos.rucio.tracer"
    prefetch_size: "10"
    chunksize: "10"
    subscription_id: "rucio-tracer-listener"
    reconnect_attempts: "100"
    dataset_wait: "60"

  conveyor:
    scheme: "gsiftp,root,https,davs,srm,http"
    transfertool: "fts3"
    ftshosts: "https://fts01.pic.es:8446,https://fts02.pic.es:8446"
    ftsmonhosts: "https://fts01.pic.es:8446,https://fts02.pic.es:8446"
    cacert: "/opt/certs/ca.pem"
    # usercert: "/opt/proxy/proxy-volume"
    usercert: "/opt/proxy/x509up"
    queue_mode: "strict"
    user_deterministic_id: "True"

  policy:
    permission: "generic"
    schema: "generic"
    lfn2pfn_algorithm_default: "identity"

  monitor:
    carbon_server: "graphite-test.pic.es"
    carbon_port: "2014"
    user_scope: "rucio"
    enable_metrics: "True"

  trace:
    username: "admin"
    password: "admin"
    port: "32005"
    nonssl_port: "32005"
    brokers: "192.168.96.77"
    tracedir: "/var/log/rucio/trace"
    topic: "/topic/rucio.tracer"

  monitor:
    carbon_server: "graphite-test.pic.es"
    carbon_port: "2014"
    user_scope: "rucio"
    enable_metrics: "True"

automaticRestart:
  enabled: 1
  image:
    repository: bitnami/kubectl
    tag: 1.18
    pullPolicy: IfNotPresent
  schedule: "5 1 * * *"

